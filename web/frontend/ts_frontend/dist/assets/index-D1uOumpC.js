(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();function a(l,e={},t=[]){const i=document.createElement(l);return e&&Object.entries(e).forEach(([s,n])=>{i[s]=n}),t&&t.length>0&&!(e!=null&&e.innerHTML)&&t.forEach(s=>{typeof s=="string"?i.appendChild(document.createTextNode(s)):i.appendChild(s)}),i}function f(l,e="",t){const i=a("button",{className:`${e} focus:outline-none`,innerHTML:l});return t&&i.addEventListener("click",t),i}function ue(l="text",e="",t=""){return a("input",{type:l,placeholder:e,className:`${t} focus:outline-none`})}function pe(l){for(;l.firstChild;)l.removeChild(l.firstChild)}function te(l,e){pe(e),e.appendChild(l)}class me{constructor(){this.routes=[],this.currentPath="/",window.addEventListener("popstate",()=>{this.handleRoute()}),this.currentPath=window.location.pathname}addRoute(e,t,i=!1){this.routes.push({path:e,handler:t,requiresAuth:i})}navigate(e){this.currentPath=e,window.history.pushState({},"",e),this.handleRoute()}handleRoute(){const e=this.routes.find(t=>t.path===this.currentPath);e?e.handler():this.navigate("/")}getCurrentPath(){return this.currentPath}start(){this.handleRoute()}}const x=new me,H="/api";class ge{constructor(){this.token=null,this.token=localStorage.getItem("token")}saveToken(e){this.token=e,localStorage.setItem("token",e)}getToken(){return this.token}removeToken(){this.token=null,localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("id"),localStorage.removeItem("mail"),localStorage.removeItem("username")}async login(e){const t=await fetch(`${H}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await t.json();if(!t.ok)throw new Error(i.error||i.message||"Login failed");return i}async register(e){const t=await fetch(`${H}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await t.json();if(!t.ok)throw new Error(i.error||i.message||"Registration failed");return i}async googleAuth(e){const t=await fetch(`${H}/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:e})}),i=await t.json();if(!t.ok)throw new Error(i.error||i.message||"Google authentication failed");return i}async makeAuthenticatedRequest(e,t={}){const i={"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},s=await fetch(`${H}${e}`,{...t,headers:{...i,...t.headers}});if(s.status===401)throw this.removeToken(),new Error("Session expired");return s}}const b=new ge;class fe{constructor(){this.user=null,this.isLoading=!0,this.error=null,this.successMessage=null,this.listeners=new Set,this.initializeAuth()}async initializeAuth(){if(b.getToken())try{const i=await(await b.makeAuthenticatedRequest("/token")).json();localStorage.setItem("token",i.token),localStorage.setItem("user",JSON.stringify(i.user));const s=localStorage.getItem("user");if(s){const n=JSON.parse(s);localStorage.setItem("username",n.username),localStorage.setItem("id",n.id),localStorage.setItem("mail",n.mail),this.user=n,x.navigate("/")}}catch(t){console.error("Auth initialization failed:",t),b.removeToken()}this.isLoading=!1,this.notifyListeners()}notifyListeners(){this.listeners.forEach(e=>e())}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}getState(){return{user:this.user,isAuthenticated:!!this.user,isLoading:this.isLoading,error:this.error,successMessage:this.successMessage}}async login(e,t){try{this.isLoading=!0,this.error=null,this.successMessage=null,this.notifyListeners();const i=await b.login({username:e,password:t});b.saveToken(i.token),this.user=i.user,this.successMessage="Login successful!",x.navigate("/")}catch(i){const s=i instanceof Error?i.message:"Login failed";throw this.error=s,i}finally{this.isLoading=!1,this.notifyListeners()}}async register(e,t,i){try{this.isLoading=!0,this.error=null,this.successMessage=null,this.notifyListeners();const s=await b.register({mail:e,username:t,psw:i});b.saveToken(s.token),this.user=s.user,x.navigate("/")}catch(s){const n=s instanceof Error?s.message:"Registration failed";throw this.error=n,s}finally{this.isLoading=!1,this.notifyListeners()}}async googleAuth(e){try{this.isLoading=!0,this.error=null,this.successMessage=null,this.notifyListeners();const t=await b.googleAuth(e);b.saveToken(t.token),this.user=t.user,this.successMessage="Google login successful!",localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("username",t.user.username),localStorage.setItem("id",t.user.id.toString()),localStorage.setItem("mail",t.user.mail),x.navigate("/")}catch(t){const i=t instanceof Error?t.message:"Google authentication failed";throw this.error=i,t}finally{this.isLoading=!1,this.notifyListeners()}}logout(){b.removeToken(),this.user=null,this.error=null,this.successMessage=null,this.notifyListeners()}clearError(){this.error=null,this.notifyListeners()}clearSuccessMessage(){this.successMessage=null,this.notifyListeners()}updateUser(e){this.user=e,localStorage.setItem("user",JSON.stringify(e)),this.notifyListeners()}}const c=new fe;class G{static async uploadProfileImage(e){const t=new FormData;t.append("profileImage",e);const i=await fetch("/api/user/upload-avatar",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:t});if(!i.ok)throw new Error("Failed to upload image");return(await i.json()).imageUrl}static validateImageFile(e){return["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)?e.size>5242880?"Il file √® troppo grande. Massimo 5MB.":null:"Formato file non supportato. Usa JPEG, PNG, GIF o WebP."}static previewImage(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=n=>{var o;(o=n.target)!=null&&o.result?t(n.target.result):i(new Error("Failed to read file"))},s.onerror=()=>i(new Error("Failed to read file")),s.readAsDataURL(e)})}}class ve{constructor(e,t){this.isUploading=!1,this.onImageUploaded=t,this.element=this.createElement(e)}createElement(e){const t=a("div",{className:"w-20 h-20 rounded-lg flex items-center justify-center border-4 border-orange-500 bg-gray-700 cursor-pointer hover:bg-gray-600 transition-all group relative overflow-hidden"});this.imagePreview=a("img",{className:"w-full h-full object-cover",src:e||"",alt:"Profile Image",style:e?"display: block;":"display: none;"});const i=a("div",{className:"text-white font-bold text-2xl flex items-center justify-center w-full h-full",innerHTML:"IMG",style:e?"display: none;":"display: flex;"}),s=a("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",innerHTML:`<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
      </svg>`});return this.fileInput=a("input",{type:"file",accept:"image/*",className:"hidden"}),this.fileInput.addEventListener("change",n=>this.handleFileSelect(n)),t.addEventListener("click",()=>this.fileInput.click()),t.appendChild(this.imagePreview),t.appendChild(i),t.appendChild(s),t.appendChild(this.fileInput),t}async handleFileSelect(e){var n;const i=(n=e.target.files)==null?void 0:n[0];if(!i)return;const s=G.validateImageFile(i);if(s){alert(s);return}try{const o=await G.previewImage(i);this.updateImageDisplay(o,!0),await this.uploadImage(i)}catch(o){console.error("Error handling file:",o),alert("Errore durante la gestione del file")}}async uploadImage(e){var i;const t=e||((i=this.fileInput.files)==null?void 0:i[0]);if(!(!t||this.isUploading)){this.isUploading=!0,this.showLoadingState();try{const s=await G.uploadProfileImage(t),n=c.getState().user;if(n){const o={...n,profileImage:s};c.updateUser(o)}this.updateImageDisplay(s,!1),this.onImageUploaded&&this.onImageUploaded(s),alert("Immagine caricata con successo!")}catch(s){console.error("Error uploading image:",s),alert("Errore durante il caricamento dell'immagine"),this.resetToDefaultState()}finally{this.isUploading=!1}}}updateImageDisplay(e,t){this.imagePreview.src=e,this.imagePreview.style.display="block";const i=this.element.querySelector('div[innerHTML*="IMG"]');i&&(i.style.display="none")}showLoadingState(){const e=this.element.querySelector(".group-hover\\:opacity-100");e&&(e.innerHTML=`<svg class="w-6 h-6 text-white animate-spin" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>`,e.classList.remove("opacity-0"),e.classList.add("opacity-100"))}resetToDefaultState(){const e=this.element.querySelector(".opacity-100");e&&(e.innerHTML=`<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
      </svg>`,e.classList.remove("opacity-100"),e.classList.add("opacity-0"))}getElement(){return this.element}updateImage(e){this.imagePreview.src=e}destroy(){this.fileInput.removeEventListener("change",this.handleFileSelect)}}const M={primary:"#E67923",dark:"#2A2A2A",white:"#ffffff"};class be{constructor(){this.isVisible=!1}show(e){this.isVisible||(this.isVisible=!0,this.modalElement=this.createModal(e),document.body.appendChild(this.modalElement))}hide(){!this.isVisible||!this.modalElement||(this.isVisible=!1,document.body.removeChild(this.modalElement),this.modalElement=void 0)}createModal(e){const{user:t}=c.getState(),s=e||{matchesPlayed:10,matchesWon:5,matchesLost:5,goalsScored:20,tournamentsWon:2,rank:1},n=a("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:"background-color: rgba(0, 0, 0, 0.5);"}),o=a("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden flex flex-col p-8 relative",style:`background-color: ${M.dark};`}),r=f(`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>`,"absolute top-4 right-4 hover:opacity-70 transition-opacity focus:outline-none",()=>this.hide());r.style.color=M.primary;const h=a("h2",{className:"text-2xl font-bold mb-6 text-center",innerHTML:`Profilo: ${(t==null?void 0:t.username)||"Giocatore"}`,style:`color: ${M.primary};`}),d=a("div",{className:"flex flex-col items-center",style:`color: ${M.white};`}),m=a("div",{className:"w-full max-w-lg mb-8"}),u=a("table",{className:"w-full mb-4 border-separate border-spacing-10"}),p=a("tbody"),v=a("tr"),w=a("td",{className:"align-middle w-32"}),$=new ve(t==null?void 0:t.profileImage,Z=>{});w.appendChild($.getElement());const S=a("td",{className:"align-middle"}),E=a("div",{className:"space-y-5"}),C=a("div",{className:"text-sm text-left",innerHTML:`<span><strong>Mail:</strong> ${(t==null?void 0:t.mail)||"N/A"}</span>`}),L=a("div",{className:"text-sm text-left"}),N=a("div",{className:"flex items-center"}),k=a("span",{className:"text-sm font-medium mr-2",innerHTML:"<strong>Wallet:</strong>"}),z=f("Collega Wallet","text-white px-3 py-1 rounded text-sm hover:opacity-90 transition-opacity focus:outline-none",()=>alert("Collega Wallet"));z.style.backgroundColor=M.primary,N.appendChild(k),N.appendChild(z),L.appendChild(N),E.appendChild(C),E.appendChild(L),S.appendChild(E),v.appendChild(w),v.appendChild(S),p.appendChild(v),u.appendChild(p),m.appendChild(u);const R=a("div",{className:"w-full max-w-lg mb-8"}),I=a("div",{className:"grid grid-cols-3 gap-6 mb-8"}),j=a("div",{className:"text-center"});j.innerHTML=`
      <div class="text-2xl font-bold" style="color: ${M.primary};">#${s.rank||1}</div>
      <div class="text-sm">Posizione</div>
    `;const O=a("div",{className:"text-center"}),se=(s.matchesWon/Math.max(s.matchesPlayed,1)*100).toFixed(1);O.innerHTML=`
      <div class="text-2xl font-bold text-green-400">${se}%</div>
      <div class="text-sm">Win Rate</div>
    `;const U=a("div",{className:"text-center"});U.innerHTML=`
      <div class="text-2xl font-bold" style="color: ${M.primary};">${s.tournamentsWon}</div>
      <div class="text-sm">Tornei</div>
    `,I.appendChild(j),I.appendChild(O),I.appendChild(U),R.appendChild(I);const T=a("div",{className:"grid grid-cols-4 gap-6 mb-8"}),V=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(34, 197, 94, 0.1);"}),ie=(s.goalsScored/Math.max(s.matchesPlayed,1)).toFixed(1);V.innerHTML=`
      <div class="text-sm text-green-400 mb-2">üéØ Goal Fatti</div>
      <div class="text-3xl font-bold mb-1">${s.goalsScored}</div>
      <div class="text-xs">Media: ${ie} per partita</div>
    `;const W=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(239, 68, 68, 0.1);"}),P=Math.floor(s.goalsScored*.7),ae=(P/Math.max(s.matchesPlayed,1)).toFixed(1);W.innerHTML=`
      <div class="text-sm text-red-400 mb-2">ü•Ö Goal Ricevuti</div>
      <div class="text-3xl font-bold mb-1">${P}</div>
      <div class="text-xs">Media: ${ae} per partita</div>
    `;const q=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(59, 130, 246, 0.1);"});q.innerHTML=`
      <div class="text-sm text-blue-400 mb-2">üéÆ Partite Totali</div>
      <div class="text-3xl font-bold mb-1">${s.matchesPlayed}</div>
      <div class="text-xs">Esperienza di gioco</div>
    `;const J=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(251, 191, 36, 0.1);"});J.innerHTML=`
      <div class="text-sm text-yellow-400 mb-2">üèÜ Tornei Vinti</div>
      <div class="text-3xl font-bold mb-1">${s.tournamentsWon}</div>
      <div class="text-xs">Campione</div>
    `,T.appendChild(V),T.appendChild(W),T.appendChild(q),T.appendChild(J);const A=a("div",{className:"w-full max-w-lg"}),ne=a("h3",{className:"text-lg font-bold mb-6",innerHTML:"Risultati Partite",style:`color: ${M.primary};`}),B=a("div",{className:"space-y-6"}),_=a("div",{className:"flex justify-between items-center py-4"}),oe=(s.matchesWon/Math.max(s.matchesPlayed,1)*100).toFixed(1);_.innerHTML=`
      <span class="text-sm">üìà Partite Vinte</span>
      <div class="flex items-center justify-end flex-1 ml-4">
        <span class="text-2xl font-bold text-green-400 mr-3">${s.matchesWon}</span>
        <span class="text-sm">${oe}% win rate</span>
      </div>
    `;const K=a("div",{className:"flex justify-between items-center py-4"}),re=(s.matchesLost/Math.max(s.matchesPlayed,1)*100).toFixed(1);K.innerHTML=`
      <span class="text-sm">üìâ Partite Perse</span>
      <div class="flex items-center justify-end flex-1 ml-4">
        <span class="text-2xl font-bold text-red-400 mr-3">${s.matchesLost}</span>
        <span class="text-sm">${re}% loss rate</span>
      </div>
    `,B.appendChild(_),B.appendChild(K);const D=a("div",{className:"mt-8"}),le=a("h4",{className:"text-md font-bold mb-4",innerHTML:"Analisi Goal",style:`color: ${M.primary};`}),X=a("div",{className:"w-full bg-gray-700 rounded-full h-3 mb-4"}),de=s.goalsScored+P,ce=Math.min(s.goalsScored/Math.max(de,1)*100,100),he=a("div",{className:"bg-green-400 h-3 rounded-full",style:`width: ${ce}%;`});X.appendChild(he);const F=a("div",{className:"flex justify-between text-sm"}),Q=a("div",{className:"text-center"});Q.innerHTML=`
      <div class="text-2xl font-bold text-green-400">${s.goalsScored}</div>
      <div class="text-sm">Segnati</div>
    `;const Y=a("div",{className:"text-center"});return Y.innerHTML=`
      <div class="text-2xl font-bold text-red-400">${P}</div>
      <div class="text-sm">Subiti</div>
    `,F.appendChild(Q),F.appendChild(Y),D.appendChild(le),D.appendChild(X),D.appendChild(F),A.appendChild(ne),A.appendChild(B),A.appendChild(D),d.appendChild(m),d.appendChild(R),d.appendChild(T),d.appendChild(A),o.appendChild(r),o.appendChild(h),o.appendChild(d),n.appendChild(o),n.addEventListener("click",Z=>{Z.target===n&&this.hide()}),n}destroy(){this.hide()}}const y={primary:"#E67923",dark:"#2A2A2A",white:"#ffffff"};class ye{constructor(){this.isVisible=!1,this.selectedFriend=null,this.newMessage="",this.friends=[{id:1,username:"alice",status:"online"},{id:2,username:"bob",status:"offline"},{id:3,username:"charlie",status:"online"}],this.messages={1:[{id:1,sender:"alice",content:"Ciao! Come va?",timestamp:new Date(Date.now()-3e5)},{id:2,sender:"Tu",content:"Tutto bene, grazie! Tu?",timestamp:new Date(Date.now()-24e4)},{id:3,sender:"alice",content:"Perfetto! Hai voglia di fare una partita?",timestamp:new Date(Date.now()-18e4)}],2:[{id:4,sender:"bob",content:"Hey, sei disponibile per giocare?",timestamp:new Date(Date.now()-6e5)}],3:[{id:5,sender:"charlie",content:"Ottima partita!",timestamp:new Date(Date.now()-12e4)},{id:6,sender:"Tu",content:"Grazie, anche tu hai giocato benissimo!",timestamp:new Date(Date.now()-6e4)}]}}show(){this.isVisible||(this.isVisible=!0,this.modalElement=this.createModal(),document.body.appendChild(this.modalElement))}hide(){!this.isVisible||!this.modalElement||(this.isVisible=!1,document.body.removeChild(this.modalElement),this.modalElement=void 0,this.selectedFriend=null,this.newMessage="")}createModal(){const{user:e}=c.getState(),t=a("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:"background-color: rgba(0, 0, 0, 0.5);"}),i=a("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl mx-4 overflow-hidden flex flex-col p-8 relative h-3/4",style:`background-color: ${y.dark};`}),s=f(`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>`,"absolute top-4 right-4 hover:opacity-70 transition-opacity focus:outline-none",()=>this.hide());s.style.color=y.primary;const n=a("h2",{className:"text-2xl font-bold mb-6 text-center",innerHTML:"Social",style:`color: ${y.primary};`}),o=a("div",{className:"flex-1 overflow-hidden",style:`color: ${y.white};`}),r=a("table",{className:"w-full h-full border-separate border-spacing-4"}),h=a("tbody"),d=a("tr",{className:"h-full"}),m=a("td",{className:"w-1/3 align-top"}),u=a("div",{className:"h-full flex flex-col"}),p=a("h3",{className:"text-lg font-bold mb-4",innerHTML:"Amici",style:`color: ${y.primary};`}),v=a("div",{className:"flex-1 overflow-y-auto space-y-2 mb-4"});this.friends.forEach(C=>{var N,k;const L=a("div",{className:`p-3 rounded cursor-pointer transition-colors ${((N=this.selectedFriend)==null?void 0:N.id)===C.id?"bg-opacity-30":"bg-opacity-10"}`,style:((k=this.selectedFriend)==null?void 0:k.id)===C.id?`background-color: ${y.primary}30;`:"background-color: rgba(255, 255, 255, 0.1);"});L.innerHTML=`
        <div class="flex items-center justify-between">
          <span class="font-medium">${C.username}</span>
          <span class="w-3 h-3 rounded-full ${C.status==="online"?"bg-green-400":"bg-gray-400"}"></span>
        </div>
      `,L.addEventListener("click",()=>{this.selectedFriend=C,this.refreshModal()}),v.appendChild(L)});const w=f("+ Aggiungi Amico","text-white px-4 py-2 rounded text-sm hover:opacity-90 transition-opacity focus:outline-none w-full",()=>alert("Aggiungi Amico"));w.style.backgroundColor=y.primary;const $=a("input",{className:"bg-gray-800 text-white px-4 py-2 rounded text-sm w-full mt-2",placeholder:"id amico"});u.appendChild(p),u.appendChild(v),u.appendChild(w),u.appendChild($),m.appendChild(u);const S=a("td",{className:"w-2/3 align-top"}),E=this.createChatContent(e);return S.appendChild(E),d.appendChild(m),d.appendChild(S),h.appendChild(d),r.appendChild(h),o.appendChild(r),i.appendChild(s),i.appendChild(n),i.appendChild(o),t.appendChild(i),t.addEventListener("click",C=>{C.target===t&&this.hide()}),t}createChatContent(e){const t=a("div",{className:"h-full flex flex-col"});if(this.selectedFriend){const i=a("div",{className:"flex items-center mb-4"}),s=a("h3",{className:"text-lg font-bold",innerHTML:`Chat con ${this.selectedFriend.username}`,style:`color: ${y.primary};`}),n=a("span",{className:`ml-3 w-3 h-3 rounded-full ${this.selectedFriend.status==="online"?"bg-green-400":"bg-gray-400"}`});i.appendChild(s),i.appendChild(n);const o=a("div",{className:"flex-1 overflow-y-auto bg-gray-800 rounded p-4 mb-4 space-y-3"}),r=this.messages[this.selectedFriend.id]||[],h=(e==null?void 0:e.username)||"Tu";r.forEach(p=>{const v=a("div",{className:`flex ${p.sender===h?"justify-end":"justify-start"}`}),w=a("div",{className:`max-w-xs px-3 py-2 rounded text-sm ${p.sender===h?"text-white":"bg-gray-600 text-white"}`});p.sender===h&&(w.style.backgroundColor=y.primary),w.innerHTML=`
          <div class="font-medium text-xs mb-1 opacity-70">${p.sender}</div>
          <div>${p.content}</div>
        `,v.appendChild(w),o.appendChild(v)});const d=a("div",{className:"flex gap-2"}),m=a("input",{className:"flex-1 px-3 py-2 rounded bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Scrivi un messaggio..."});m.value=this.newMessage,m.addEventListener("input",p=>{this.newMessage=p.target.value}),m.addEventListener("keypress",p=>{p.key==="Enter"&&this.sendMessage(h)});const u=f("Invia","text-white px-4 py-2 rounded hover:opacity-90 transition-opacity focus:outline-none",()=>this.sendMessage(h));u.style.backgroundColor=y.primary,d.appendChild(m),d.appendChild(u),t.appendChild(i),t.appendChild(o),t.appendChild(d)}else{const i=a("div",{className:"h-full flex items-center justify-center"}),s=a("p",{className:"text-gray-400 text-center",innerHTML:"Seleziona un amico per iniziare a chattare"});i.appendChild(s),t.appendChild(i)}return t}sendMessage(e){if(!this.selectedFriend||!this.newMessage.trim())return;const t={id:Date.now(),sender:e,content:this.newMessage,timestamp:new Date};this.messages[this.selectedFriend.id]||(this.messages[this.selectedFriend.id]=[]),this.messages[this.selectedFriend.id].push(t),this.newMessage="",this.refreshModal()}refreshModal(){this.modalElement&&(document.body.removeChild(this.modalElement),this.modalElement=this.createModal(),document.body.appendChild(this.modalElement))}destroy(){this.hide()}}class xe{constructor(){this.profileModal=new be,this.socialModal=new ye,this.element=this.createNavbar(),this.bindAuthState()}bindAuthState(){this.unsubscribe=c.subscribe(()=>{this.updateNavbar()})}createNavbar(){const e=a("nav",{className:"min-h-screen w-44 py-6 px-4 flex flex-col shadow-lg",style:"background-color: #3B2E27;"});return this.element=e,this.updateNavbar(),e}updateNavbar(){const{user:e}=c.getState();for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);const t=a("div",{className:"mb-8"}),i=f(`<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
      </svg>
      <span class="text-sm">Home</span>`,"text-white font-semibold text-lg flex flex-col items-center gap-2 hover:text-orange-300 transition-colors w-full p-4",()=>x.navigate("/"));i.style.color="#E67923",t.appendChild(i),this.element.appendChild(t);const s=a("div",{className:"flex-1 flex flex-col justify-center"});e&&s.appendChild(this.createAuthenticatedButtons(e)),this.element.appendChild(s)}createAuthenticatedButtons(e){const t=a("div",{className:"flex flex-col gap-4 w-full"}),i=a("div",{className:"text-white text-center text-sm mb-4 px-2",innerHTML:`Ciao, ${e.username}!`}),s=f("Profilo","text-white px-3 py-2 rounded transition-all focus:outline-none w-full text-center",()=>this.profileModal.show());s.style.backgroundColor="#E67923",s.addEventListener("mouseenter",()=>{s.style.backgroundColor="#D16A1E"}),s.addEventListener("mouseleave",()=>{s.style.backgroundColor="#E67923"});const n=f("Play","text-white px-3 py-2 rounded-md transition-all w-full text-center bg-orange-500 hover:bg-orange-600 focus:outline-none",()=>x.navigate("/play")),o=f("Social","text-white px-3 py-2 rounded-md transition-all w-full text-center bg-orange-500 hover:bg-orange-600 focus:outline-none",()=>this.socialModal.show()),r=f("Logout","text-white px-3 py-2 rounded transition-all focus:outline-none w-full text-center",()=>{c.logout(),x.navigate("/")});return r.style.backgroundColor="#6B7280",r.addEventListener("mouseenter",()=>{r.style.backgroundColor="#4B5563"}),r.addEventListener("mouseleave",()=>{r.style.backgroundColor="#6B7280"}),t.appendChild(i),t.appendChild(s),t.appendChild(n),t.appendChild(o),t.appendChild(r),t}getElement(){return this.element}destroy(){this.unsubscribe&&this.unsubscribe(),this.profileModal.destroy(),this.socialModal.destroy()}}const we="575747097249-3bu3g738p6s49pisr9ael83r4p5p1urv.apps.googleusercontent.com";class Ce{constructor(){this.isInitialized=!1}async initialize(){if(!this.isInitialized)return new Promise((e,t)=>{if(window.googleAuthCallback=this.handleCredentialResponse.bind(this),window.google)this.initializeGoogleAuth(),this.isInitialized=!0,e();else{const i=document.createElement("script");i.src="https://accounts.google.com/gsi/client",i.onload=()=>{this.initializeGoogleAuth(),this.isInitialized=!0,e()},i.onerror=()=>t(new Error("Failed to load Google Identity Services")),document.head.appendChild(i)}})}initializeGoogleAuth(){window.google.accounts.id.initialize({client_id:we,callback:window.googleAuthCallback})}async handleCredentialResponse(e){try{await c.googleAuth(e.credential)}catch(t){console.error("Google auth error:",t)}}renderButton(e){if(!this.isInitialized){console.error("Google Auth not initialized");return}window.google.accounts.id.renderButton(e,{theme:"outline",size:"large",width:"100%",text:"continue_with"})}}const ee=new Ce,g={primary:"#E67923",dark:"#2A2A2A",darkText:"#3C3C3C",loginButton:"#B20000",loginButtonHover:"#D32F2F",white:"#ffffff",lightGray:"#f5f5f5"},Me=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;class Le{constructor(e=!0){this.isVisible=!1,this.activeTab="login",this.formData={email:"",username:"",password:"",confirmPassword:""},this.errors={},this.showCloseButton=!0,this.showCloseButton=e,this.bindAuthState(),this.initializeGoogleAuth()}async initializeGoogleAuth(){try{await ee.initialize()}catch(e){console.error("Failed to initialize Google Auth:",e)}}bindAuthState(){this.unsubscribe=c.subscribe(()=>{this.updateErrorDisplay()})}show(){this.isVisible||(this.isVisible=!0,this.modalElement=this.createModal(),document.body.appendChild(this.modalElement))}hide(){!this.isVisible||!this.modalElement||(this.isVisible=!1,document.body.removeChild(this.modalElement),this.modalElement=void 0,this.resetForm())}createModal(){const e=a("div",{className:"fixed inset-0 flex items-center justify-center z-50"});this.showCloseButton&&e.addEventListener("click",o=>{o.target===e&&this.hide()});const t=a("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 h-[500px] overflow-hidden flex flex-col",style:`background-color: ${g.dark};`});if(t.addEventListener("click",o=>o.stopPropagation()),this.showCloseButton){const o=a("div",{className:"relative px-6 pt-4 pb-4"}),r=f("√ó","absolute top-4 right-4 hover:opacity-70 transition-opacity focus:outline-none text-2xl",()=>this.hide());r.style.color=g.primary,o.appendChild(r),t.appendChild(o)}const i=this.createTabs();t.appendChild(i);const s=a("div",{className:"flex-1 flex flex-col"}),n=this.createForm();return s.appendChild(n),t.appendChild(s),e.appendChild(t),e}createTabs(){const e=a("div",{className:"px-6 mt-4"});return[{id:"login",label:"Log In"},{id:"register",label:"Sign Up"}].forEach(i=>{const s=f(i.label,"pb-3 px-1 text-lg font-semibold border-b-2 transition-all mr-8 focus:outline-none hover:opacity-70",()=>this.switchTab(i.id));s.style.color=this.activeTab===i.id?g.primary:g.darkText,s.style.borderBottomColor=this.activeTab===i.id?g.primary:"transparent",e.appendChild(s)}),e}createForm(){const e=a("form",{className:"flex flex-col gap-5 pt-4 px-8 pb-6 flex-1 min-h-[300px] items-center"});e.addEventListener("submit",o=>this.handleSubmit(o));const t=a("div",{className:"w-full max-w-sm mb-4"});this.updateMessageContainer(t);const i=a("div",{className:"flex flex-col gap-6 flex-grow w-full max-w-sm"});i.appendChild(this.createField("email","Email Address","email","Enter your email address...")),this.activeTab==="register"&&i.appendChild(this.createField("username","Username","text","Enter your username...")),i.appendChild(this.createField("password","Password","password",this.activeTab==="login"?"Enter your password...":"Create a password...")),this.activeTab==="register"&&i.appendChild(this.createField("confirmPassword","Confirm Password","password","Confirm your password...")),this.activeTab==="login"&&i.appendChild(a("div",{className:"h-16"}));const s=this.createDivider(),n=this.createButtons();return e.appendChild(t),e.appendChild(i),e.appendChild(s),e.appendChild(n),e}createField(e,t,i,s){const n=a("div",{className:"flex flex-col items-center"}),o=a("label",{className:"block text-sm font-medium text-white text-center mb-2 w-full",innerHTML:t}),r=ue(i,s,`w-4/5 px-4 py-3 border rounded-lg outline-none transition-all text-center text-black placeholder-gray-500 ${this.errors[e]?"border-red-500":"border-gray-700"} bg-gray-100`);r.value=this.formData[e],r.addEventListener("input",d=>this.handleInputChange(e,d.target.value));const h=a("p",{className:"text-red-500 text-sm mt-1 text-center",innerHTML:this.errors[e]||""});return n.appendChild(o),n.appendChild(r),this.errors[e]&&n.appendChild(h),n}createDivider(){const e=a("div",{className:"relative my-6 w-full max-w-sm"}),t=a("div",{className:"absolute inset-0 flex items-center"}),i=a("div",{className:"w-full border-t",style:`border-color: ${g.darkText};`}),s=a("div",{className:"relative flex justify-center text-sm"}),n=a("span",{className:"px-4 text-white",innerHTML:"or",style:`background-color: ${g.dark};`});return t.appendChild(i),s.appendChild(n),e.appendChild(t),e.appendChild(s),e}createButtons(){const e=a("div",{className:"mt-auto w-full max-w-sm"}),t=a("div",{className:"flex gap-3 mb-4 h-12"}),{isLoading:i}=c.getState(),s=f(i?"Loading...":this.activeTab==="login"?"Log in":"Create Account","flex-1 text-white py-3 px-4 rounded-lg font-semibold transition-all flex items-center justify-center focus:outline-none disabled:opacity-50",()=>this.handleFormSubmit());s.style.backgroundColor=g.loginButton,s.disabled=i,s.addEventListener("mouseenter",()=>{i||(s.style.backgroundColor=g.loginButtonHover)}),s.addEventListener("mouseleave",()=>{i||(s.style.backgroundColor=g.loginButton)});const n=this.createGoogleButton();return t.appendChild(s),t.appendChild(n),e.appendChild(t),e}createGoogleButton(){const e=a("div",{className:"w-full"}),t=a("div",{className:"w-full",id:"google-signin-button"});return e.appendChild(t),setTimeout(()=>{try{ee.renderButton(t)}catch(i){console.error("Error rendering Google button:",i),this.createFallbackGoogleButton(t)}},100),e}createFallbackGoogleButton(e){e.innerHTML="";const t=f(`<svg class="w-5 h-5 mr-3" viewBox="0 0 24 24">
        <path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
        <path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
        <path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
        <path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
      </svg>
      Continue with Google`,"flex items-center justify-center px-4 py-3 border rounded-lg font-semibold cursor-pointer h-12 whitespace-nowrap transition-all focus:outline-none text-black w-full");t.style.backgroundColor=g.white,t.style.borderColor=g.darkText,t.style.color="#000000",t.addEventListener("mouseenter",()=>{t.style.backgroundColor=g.lightGray}),t.addEventListener("mouseleave",()=>{t.style.backgroundColor=g.white}),e.appendChild(t)}handleInputChange(e,t){this.formData[e]=t,this.errors[e]&&delete this.errors[e],c.clearError(),c.clearSuccessMessage()}switchTab(e){this.activeTab=e,this.resetForm(),this.refreshModal()}resetForm(){this.formData={email:"",username:"",password:"",confirmPassword:""},this.errors={}}refreshModal(){if(this.modalElement&&this.modalElement.parentNode){const e=this.createModal();this.modalElement.parentNode.replaceChild(e,this.modalElement),this.modalElement=e}}updateMessageContainer(e){const{error:t,successMessage:i}=c.getState();if(e.innerHTML="",t){const s=a("p",{className:"text-red-500 text-sm text-center bg-red-100 p-2 rounded",innerHTML:t});e.appendChild(s)}if(i){const s=a("p",{className:"text-green-500 text-sm text-center bg-green-100 p-2 rounded",innerHTML:i});e.appendChild(s)}}updateErrorDisplay(){if(this.modalElement){const e=this.modalElement.querySelector(".w-full.max-w-sm.mb-4");e&&this.updateMessageContainer(e)}}validateForm(){const e={};return Me.test(this.formData.email)||(e.email="Please enter a valid email address"),this.activeTab==="register"&&!this.formData.username.trim()&&(e.username="Username is required"),this.formData.password.length<6&&(e.password="Password must be at least 6 characters"),this.activeTab==="register"&&this.formData.password!==this.formData.confirmPassword&&(e.confirmPassword="Passwords do not match"),this.errors=e,Object.keys(e).length===0}handleSubmit(e){e.preventDefault(),this.handleFormSubmit()}async handleFormSubmit(){if(!this.validateForm()){this.refreshModal();return}try{this.activeTab==="login"?await c.login(this.formData.email,this.formData.password):await c.register(this.formData.email,this.formData.username,this.formData.password),this.hide()}catch(e){console.error("Auth error:",e)}}destroy(){this.hide(),this.unsubscribe&&this.unsubscribe()}}class Ne{constructor(e){this.container=e,this.authModal=new Le(!1),this.bindAuthState(),this.checkAuthState()}bindAuthState(){this.unsubscribe=c.subscribe(()=>{this.checkAuthState()})}checkAuthState(){const{isAuthenticated:e,isLoading:t}=c.getState();t?this.showLoading():e?this.authModal.hide():this.authModal.show()}showLoading(){}setContent(e){const{isAuthenticated:t}=c.getState();t&&(this.currentContent=e,te(e,this.container))}destroy(){this.unsubscribe&&this.unsubscribe(),this.authModal.destroy()}}class Se{constructor(){this.element=this.createPage()}createPage(){const e=a("div",{className:"p-6"}),t=a("h1",{className:"text-3xl font-bold text-gray-800 mb-6",innerHTML:"Benvenuto a ft_transcendence"}),i=a("div",{className:"bg-white rounded-lg shadow-md p-8"}),s=a("p",{className:"text-gray-600 text-lg mb-8",innerHTML:"Il classico gioco Pong reimplementato con tecnologie moderne. Sfida i tuoi amici o gioca contro l'IA!"}),n=a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"});return[{title:"Gioco Locale",description:"Due giocatori sullo stesso computer",bgClass:"bg-blue-50",textClass:"text-blue-800",icon:"üéÆ"},{title:"Gioco Online",description:"Sfida giocatori da tutto il mondo",bgClass:"bg-green-50",textClass:"text-green-800",icon:"üåê"},{title:"VS Intelligenza Artificiale",description:"Metti alla prova le tue abilit√† contro l'IA",bgClass:"bg-purple-50",textClass:"text-purple-800",icon:"ü§ñ"},{title:"Torneo",description:"Partecipa a tornei competitivi",bgClass:"bg-orange-50",textClass:"text-orange-800",icon:"üèÜ"}].forEach(r=>{const h=a("div",{className:`${r.bgClass} p-6 rounded-lg border border-gray-200 hover:shadow-md transition-shadow cursor-pointer`}),d=a("div",{className:"text-3xl mb-3",innerHTML:r.icon}),m=a("h3",{className:`font-semibold ${r.textClass} mb-2`,innerHTML:r.title}),u=a("p",{className:"text-gray-600 text-sm",innerHTML:r.description});h.appendChild(d),h.appendChild(m),h.appendChild(u),n.appendChild(h)}),i.appendChild(s),i.appendChild(n),e.appendChild(t),e.appendChild(i),e}getElement(){return this.element}destroy(){}}class Ee{constructor(){this.element=this.createPage()}createPage(){const e=a("div",{className:"h-full flex flex-col"}),t=a("h1",{className:"text-3xl font-bold text-gray-800 p-4 bg-white shadow-sm",innerHTML:"Gioca - Pong Game"}),i=a("div",{className:"flex-1 flex min-h-0"}),s=a("div",{className:"w-1/3 bg-gray-50 p-4 border-r-4 border-blue-500 overflow-y-auto"}),n=a("h2",{className:"text-xl font-semibold text-gray-800 mb-4",innerHTML:"Controlli di Gioco"}),o=a("div",{className:"space-y-3 text-gray-700"});["W / S - Giocatore 1 (sinistra)","Frecce Su/Gi√π - Giocatore 2 (destra)","Spacebar - Pausa/Resume","ESC - Menu principale"].forEach(p=>{const v=a("div",{className:"bg-white p-3 rounded-lg border border-gray-200",innerHTML:`<code class="text-blue-600 font-mono">${p}</code>`});o.appendChild(v)});const h=a("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",innerHTML:`
        <h3 class="font-semibold text-blue-800 mb-2">Modalit√† di Gioco</h3>
        <ul class="text-sm text-blue-700 space-y-1">
          <li>‚Ä¢ <strong>Local:</strong> Due giocatori sullo stesso computer</li>
          <li>‚Ä¢ <strong>Remote:</strong> Gioco online</li>
          <li>‚Ä¢ <strong>VS Bot:</strong> Contro l'intelligenza artificiale</li>
          <li>‚Ä¢ <strong>Tournament:</strong> Torneo con pi√π giocatori</li>
        </ul>
      `});s.appendChild(n),s.appendChild(o),s.appendChild(h);const d=a("div",{className:"w-2/3 bg-white relative min-h-0"}),m=a("iframe",{src:"https://localhost/game/",className:"w-full h-full border-0",style:"min-height: 500px;"}),u=a("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",innerHTML:`
        <div class="text-center">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
          <p class="text-gray-600">Caricamento gioco...</p>
        </div>
      `});return m.onload=()=>{u.style.display="none"},d.appendChild(u),d.appendChild(m),i.appendChild(s),i.appendChild(d),e.appendChild(t),e.appendChild(i),e}getElement(){return this.element}destroy(){}}class Te{constructor(){this.navbar=new xe;const{layout:e,mainContent:t}=this.initializeDOM();this.layout=e,this.mainContent=t,this.authGuard=new Ne(this.mainContent),this.setupRoutes(),this.bindAuthState(),x.start()}initializeDOM(){const e=document.getElementById("app");if(!e)throw new Error("App element not found");const t=a("div",{className:"min-h-screen bg-gray-100 flex"}),i=a("div",{className:"flex-1 p-8 min-h-screen"});return t.appendChild(this.navbar.getElement()),t.appendChild(i),te(t,e),{layout:t,mainContent:i}}setupRoutes(){x.addRoute("/",()=>this.renderPage(new Se)),x.addRoute("/play",()=>this.renderPage(new Ee))}bindAuthState(){this.unsubscribe=c.subscribe(()=>{const{isAuthenticated:e}=c.getState();e?(this.mainContent.style.display="block",this.navbar.getElement().style.display="flex"):(this.mainContent.style.display="none",this.navbar.getElement().style.display="none")})}renderPage(e){const{isAuthenticated:t}=c.getState();this.currentPage&&this.currentPage.destroy(),this.currentPage=e,t&&this.authGuard.setContent(e.getElement())}destroy(){this.unsubscribe&&this.unsubscribe(),this.navbar.destroy(),this.authGuard.destroy(),this.currentPage&&this.currentPage.destroy()}}document.addEventListener("DOMContentLoaded",()=>{new Te});
//# sourceMappingURL=index-D1uOumpC.js.map
