(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();function a(r,e={},s=[]){const i=document.createElement(r);return e&&Object.entries(e).forEach(([t,n])=>{i[t]=n}),s&&s.length>0&&!(e!=null&&e.innerHTML)&&s.forEach(t=>{typeof t=="string"?i.appendChild(document.createTextNode(t)):i.appendChild(t)}),i}function u(r,e="",s){const i=a("button",{className:`${e} focus:outline-none`,innerHTML:r});return s&&i.addEventListener("click",s),i}function he(r="text",e="",s=""){return a("input",{type:r,placeholder:e,className:`${s} focus:outline-none`})}function pe(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function ee(r,e){pe(e),e.appendChild(r)}class me{constructor(){this.routes=[],this.currentPath="/",window.addEventListener("popstate",()=>{this.handleRoute()}),this.currentPath=window.location.pathname}addRoute(e,s,i=!1){this.routes.push({path:e,handler:s,requiresAuth:i})}navigate(e){this.currentPath=e,window.history.pushState({},"",e),this.handleRoute()}handleRoute(){const e=this.routes.find(s=>s.path===this.currentPath);e?e.handler():this.navigate("/")}getCurrentPath(){return this.currentPath}start(){this.handleRoute()}}const N=new me,R="/api";class ue{constructor(){this.token=null,this.token=localStorage.getItem("token")}saveToken(e){this.token=e,localStorage.setItem("token",e)}getToken(){return this.token}removeToken(){this.token=null,localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("id"),localStorage.removeItem("mail"),localStorage.removeItem("username")}async login(e){const s=await fetch(`${R}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await s.json();if(!s.ok)throw new Error(i.error||i.message||"Login failed");return i}async register(e){const s=await fetch(`${R}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await s.json();if(!s.ok)throw new Error(i.error||i.message||"Registration failed");return i}async makeAuthenticatedRequest(e,s={}){const i={"Content-Type":"application/json",Authorization:`Bearer ${this.token}`};console.log("prima della request");const t=await fetch(`${R}${e}`,{...s,headers:{...i,...s.headers}});if(console.log("resonse ",t),t.status===401)throw this.removeToken(),new Error("Session expired");return t}}const C=new ue;class ge{constructor(){this.user=null,this.isLoading=!0,this.error=null,this.successMessage=null,this.listeners=new Set,this.initializeAuth()}async initializeAuth(){if(C.getToken())try{const i=await(await C.makeAuthenticatedRequest("/token")).json();localStorage.setItem("token",i.token),localStorage.setItem("user",JSON.stringify(i.user));const t=localStorage.getItem("user");if(t){const n=JSON.parse(t);localStorage.setItem("username",n.username),localStorage.setItem("id",n.id),localStorage.setItem("mail",n.mail),console.log("Token:",localStorage.getItem("token")),console.log("User:",localStorage.getItem("user")),this.user=n}}catch(s){console.error("Auth initialization failed:",s),C.removeToken()}this.isLoading=!1,this.notifyListeners()}notifyListeners(){this.listeners.forEach(e=>e())}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}getState(){return{user:this.user,isAuthenticated:!!this.user,isLoading:this.isLoading,error:this.error,successMessage:this.successMessage}}async login(e,s){try{this.isLoading=!0,this.error=null,this.successMessage=null,this.notifyListeners();const i=await C.login({username:e,password:s});C.saveToken(i.token),this.user=i.user,this.successMessage="Login successful!"}catch(i){const t=i instanceof Error?i.message:"Login failed";throw this.error=t,i}finally{this.isLoading=!1,this.notifyListeners()}}async register(e,s,i){try{this.isLoading=!0,this.error=null,this.successMessage=null,this.notifyListeners();const t=await C.register({mail:e,username:s,psw:i});C.saveToken(t.token),this.user=t.user}catch(t){const n=t instanceof Error?t.message:"Registration failed";throw this.error=n,t}finally{this.isLoading=!1,this.notifyListeners()}}logout(){C.removeToken(),this.user=null,this.error=null,this.successMessage=null,this.notifyListeners()}clearError(){this.error=null,this.notifyListeners()}clearSuccessMessage(){this.successMessage=null,this.notifyListeners()}updateUser(e){this.user=e,localStorage.setItem("user",JSON.stringify(e)),this.notifyListeners()}}const d=new ge;class j{static async uploadProfileImage(e){const s=new FormData;s.append("profileImage",e);const i=await fetch("/api/user/upload-avatar",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:s});if(!i.ok)throw new Error("Failed to upload image");return(await i.json()).imageUrl}static validateImageFile(e){return["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)?e.size>5242880?"Il file √® troppo grande. Massimo 5MB.":null:"Formato file non supportato. Usa JPEG, PNG, GIF o WebP."}static previewImage(e){return new Promise((s,i)=>{const t=new FileReader;t.onload=n=>{var o;(o=n.target)!=null&&o.result?s(n.target.result):i(new Error("Failed to read file"))},t.onerror=()=>i(new Error("Failed to read file")),t.readAsDataURL(e)})}}class fe{constructor(e,s){this.isUploading=!1,this.onImageUploaded=s,this.element=this.createElement(e)}createElement(e){const s=a("div",{className:"w-20 h-20 rounded-lg flex items-center justify-center border-4 border-orange-500 bg-gray-700 cursor-pointer hover:bg-gray-600 transition-all group relative overflow-hidden"});this.imagePreview=a("img",{className:"w-full h-full object-cover",src:e||"",alt:"Profile Image",style:e?"display: block;":"display: none;"});const i=a("div",{className:"text-white font-bold text-2xl",innerHTML:"PG",style:e?"display: none;":"display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;"}),t=a("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",innerHTML:`<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l9-9 9 9H3zM21 15l-3.086-3.086a2 2 0 00-2.828 0L6 21M9 9a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg>`});return this.fileInput=a("input",{type:"file",accept:"image/*",className:"hidden"}),this.fileInput.addEventListener("change",n=>this.handleFileSelect(n)),s.addEventListener("click",()=>this.fileInput.click()),s.appendChild(this.imagePreview),s.appendChild(i),s.appendChild(t),s.appendChild(this.fileInput),s}async handleFileSelect(e){var n;const i=(n=e.target.files)==null?void 0:n[0];if(!i)return;const t=j.validateImageFile(i);if(t){alert(t);return}try{const o=await j.previewImage(i);this.updateImageDisplay(o,!0),await this.uploadImage(i)}catch(o){console.error("Error handling file:",o),alert("Errore durante la gestione del file")}}async uploadImage(e){var i;const s=e||((i=this.fileInput.files)==null?void 0:i[0]);if(!(!s||this.isUploading)){this.isUploading=!0,this.showLoadingState();try{const t=await j.uploadProfileImage(s),n=d.getState().user;if(n){const o={...n,profileImage:t};d.updateUser(o)}this.updateImageDisplay(t,!1),this.onImageUploaded&&this.onImageUploaded(t),alert("Immagine caricata con successo!")}catch(t){console.error("Error uploading image:",t),alert("Errore durante il caricamento dell'immagine"),this.resetToDefaultState()}finally{this.isUploading=!1}}}updateImageDisplay(e,s){this.imagePreview.src=e,this.imagePreview.style.display="block";const i=this.element.querySelector('div[innerHTML*="PG"]');i&&(i.style.display="none")}showLoadingState(){const e=this.element.querySelector(".group-hover\\:opacity-100");e&&(e.innerHTML=`<svg class="w-6 h-6 text-white animate-spin" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>`,e.classList.remove("opacity-0"),e.classList.add("opacity-100"))}resetToDefaultState(){const e=this.element.querySelector(".opacity-100");e&&(e.innerHTML=`<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l9-9 9 9H3zM21 15l-3.086-3.086a2 2 0 00-2.828 0L6 21M9 9a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg>`,e.classList.remove("opacity-100"),e.classList.add("opacity-0"))}getElement(){return this.element}updateImage(e){this.imagePreview.src=e}destroy(){this.fileInput.removeEventListener("change",this.handleFileSelect)}}const w={primary:"#E67923",dark:"#2A2A2A",white:"#ffffff"};class ve{constructor(){this.isVisible=!1}show(e){this.isVisible||(this.isVisible=!0,this.modalElement=this.createModal(e),document.body.appendChild(this.modalElement))}hide(){!this.isVisible||!this.modalElement||(this.isVisible=!1,document.body.removeChild(this.modalElement),this.modalElement=void 0)}createModal(e){const{user:s}=d.getState(),t=e||{matchesPlayed:10,matchesWon:5,matchesLost:5,goalsScored:20,tournamentsWon:2,rank:1},n=a("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:"background-color: rgba(0, 0, 0, 0.5);"}),o=a("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden flex flex-col p-8 relative",style:`background-color: ${w.dark};`}),l=u(`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>`,"absolute top-4 right-4 hover:opacity-70 transition-opacity focus:outline-none",()=>this.hide());l.style.color=w.primary;const h=a("h2",{className:"text-2xl font-bold mb-6 text-center",innerHTML:`Profilo: ${(s==null?void 0:s.username)||"Giocatore"}`,style:`color: ${w.primary};`}),c=a("div",{className:"flex flex-col items-center",style:`color: ${w.white};`}),f=a("div",{className:"w-full max-w-lg mb-8"}),g=a("table",{className:"w-full mb-4 border-separate border-spacing-10"}),p=a("tbody"),y=a("tr"),b=a("td",{className:"align-middle w-32"}),F=new fe(s==null?void 0:s.profileImage,D=>{console.log("Profile image updated:",D)});b.appendChild(F.getElement());const E=a("td",{className:"align-middle"}),S=a("div",{className:"space-y-5"}),x=a("div",{className:"text-sm text-left",innerHTML:`<span><strong>Mail:</strong> ${(s==null?void 0:s.mail)||"N/A"}</span>`}),M=a("div",{className:"text-sm text-left"}),L=a("div",{className:"flex items-center"}),T=a("span",{className:"text-sm font-medium mr-2",innerHTML:"<strong>Wallet:</strong>"}),z=u("Collega Wallet","text-white px-3 py-1 rounded text-sm hover:opacity-90 transition-opacity focus:outline-none",()=>alert("Collega Wallet"));z.style.backgroundColor=w.primary,L.appendChild(T),L.appendChild(z),M.appendChild(L),S.appendChild(x),S.appendChild(M),E.appendChild(S),y.appendChild(b),y.appendChild(E),p.appendChild(y),g.appendChild(p),f.appendChild(g);const G=a("div",{className:"w-full max-w-lg mb-8"}),P=a("div",{className:"grid grid-cols-3 gap-6 mb-8"}),O=a("div",{className:"text-center"});O.innerHTML=`
      <div class="text-2xl font-bold" style="color: ${w.primary};">#${t.rank||1}</div>
      <div class="text-sm">Posizione</div>
    `;const U=a("div",{className:"text-center"}),te=(t.matchesWon/Math.max(t.matchesPlayed,1)*100).toFixed(1);U.innerHTML=`
      <div class="text-2xl font-bold text-green-400">${te}%</div>
      <div class="text-sm">Win Rate</div>
    `;const V=a("div",{className:"text-center"});V.innerHTML=`
      <div class="text-2xl font-bold" style="color: ${w.primary};">${t.tournamentsWon}</div>
      <div class="text-sm">Tornei</div>
    `,P.appendChild(O),P.appendChild(U),P.appendChild(V),G.appendChild(P);const k=a("div",{className:"grid grid-cols-4 gap-6 mb-8"}),W=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(34, 197, 94, 0.1);"}),se=(t.goalsScored/Math.max(t.matchesPlayed,1)).toFixed(1);W.innerHTML=`
      <div class="text-sm text-green-400 mb-2">üéØ Goal Fatti</div>
      <div class="text-3xl font-bold mb-1">${t.goalsScored}</div>
      <div class="text-xs">Media: ${se} per partita</div>
    `;const q=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(239, 68, 68, 0.1);"}),I=Math.floor(t.goalsScored*.7),ie=(I/Math.max(t.matchesPlayed,1)).toFixed(1);q.innerHTML=`
      <div class="text-sm text-red-400 mb-2">ü•Ö Goal Ricevuti</div>
      <div class="text-3xl font-bold mb-1">${I}</div>
      <div class="text-xs">Media: ${ie} per partita</div>
    `;const J=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(59, 130, 246, 0.1);"});J.innerHTML=`
      <div class="text-sm text-blue-400 mb-2">üéÆ Partite Totali</div>
      <div class="text-3xl font-bold mb-1">${t.matchesPlayed}</div>
      <div class="text-xs">Esperienza di gioco</div>
    `;const _=a("div",{className:"text-center p-4 rounded",style:"background-color: rgba(251, 191, 36, 0.1);"});_.innerHTML=`
      <div class="text-sm text-yellow-400 mb-2">üèÜ Tornei Vinti</div>
      <div class="text-3xl font-bold mb-1">${t.tournamentsWon}</div>
      <div class="text-xs">Campione</div>
    `,k.appendChild(W),k.appendChild(q),k.appendChild(J),k.appendChild(_);const A=a("div",{className:"w-full max-w-lg"}),ae=a("h3",{className:"text-lg font-bold mb-6",innerHTML:"Risultati Partite",style:`color: ${w.primary};`}),B=a("div",{className:"space-y-6"}),K=a("div",{className:"flex justify-between items-center py-4"}),ne=(t.matchesWon/Math.max(t.matchesPlayed,1)*100).toFixed(1);K.innerHTML=`
      <span class="text-sm">üìà Partite Vinte</span>
      <div class="flex items-center justify-end flex-1 ml-4">
        <span class="text-2xl font-bold text-green-400 mr-3">${t.matchesWon}</span>
        <span class="text-sm">${ne}% win rate</span>
      </div>
    `;const X=a("div",{className:"flex justify-between items-center py-4"}),oe=(t.matchesLost/Math.max(t.matchesPlayed,1)*100).toFixed(1);X.innerHTML=`
      <span class="text-sm">üìâ Partite Perse</span>
      <div class="flex items-center justify-end flex-1 ml-4">
        <span class="text-2xl font-bold text-red-400 mr-3">${t.matchesLost}</span>
        <span class="text-sm">${oe}% loss rate</span>
      </div>
    `,B.appendChild(K),B.appendChild(X);const $=a("div",{className:"mt-8"}),re=a("h4",{className:"text-md font-bold mb-4",innerHTML:"Analisi Goal",style:`color: ${w.primary};`}),Q=a("div",{className:"w-full bg-gray-700 rounded-full h-3 mb-4"}),le=t.goalsScored+I,de=Math.min(t.goalsScored/Math.max(le,1)*100,100),ce=a("div",{className:"bg-green-400 h-3 rounded-full",style:`width: ${de}%;`});Q.appendChild(ce);const H=a("div",{className:"flex justify-between text-sm"}),Y=a("div",{className:"text-center"});Y.innerHTML=`
      <div class="text-2xl font-bold text-green-400">${t.goalsScored}</div>
      <div class="text-sm">Segnati</div>
    `;const Z=a("div",{className:"text-center"});return Z.innerHTML=`
      <div class="text-2xl font-bold text-red-400">${I}</div>
      <div class="text-sm">Subiti</div>
    `,H.appendChild(Y),H.appendChild(Z),$.appendChild(re),$.appendChild(Q),$.appendChild(H),A.appendChild(ae),A.appendChild(B),A.appendChild($),c.appendChild(f),c.appendChild(G),c.appendChild(k),c.appendChild(A),o.appendChild(l),o.appendChild(h),o.appendChild(c),n.appendChild(o),n.addEventListener("click",D=>{D.target===n&&this.hide()}),n}destroy(){this.hide()}}const v={primary:"#E67923",dark:"#2A2A2A",white:"#ffffff"};class ye{constructor(){this.isVisible=!1,this.selectedFriend=null,this.newMessage="",this.friends=[{id:1,username:"ges√π",status:"online"},{id:2,username:"mario",status:"offline"}],this.messages={1:[{id:1,sender:"Mario",content:"dio merda?",timestamp:new Date},{id:2,sender:"Tu",content:"ovvio",timestamp:new Date}],2:[{id:3,sender:"mario",content:"come va?",timestamp:new Date}]}}show(){this.isVisible||(this.isVisible=!0,this.modalElement=this.createModal(),document.body.appendChild(this.modalElement))}hide(){!this.isVisible||!this.modalElement||(this.isVisible=!1,document.body.removeChild(this.modalElement),this.modalElement=void 0,this.selectedFriend=null,this.newMessage="")}createModal(){const{user:e}=d.getState(),s=a("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:"background-color: rgba(0, 0, 0, 0.5);"}),i=a("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl mx-4 overflow-hidden flex flex-col p-8 relative h-3/4",style:`background-color: ${v.dark};`}),t=u(`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>`,"absolute top-4 right-4 hover:opacity-70 transition-opacity focus:outline-none",()=>this.hide());t.style.color=v.primary;const n=a("h2",{className:"text-2xl font-bold mb-6 text-center",innerHTML:"Social",style:`color: ${v.primary};`}),o=a("div",{className:"flex-1 overflow-hidden",style:`color: ${v.white};`}),l=a("table",{className:"w-full h-full border-separate border-spacing-4"}),h=a("tbody"),c=a("tr",{className:"h-full"}),f=a("td",{className:"w-1/3 align-top"}),g=a("div",{className:"h-full flex flex-col"}),p=a("h3",{className:"text-lg font-bold mb-4",innerHTML:"Amici",style:`color: ${v.primary};`}),y=a("div",{className:"flex-1 overflow-y-auto space-y-2 mb-4"});this.friends.forEach(x=>{var L,T;const M=a("div",{className:`p-3 rounded cursor-pointer transition-colors ${((L=this.selectedFriend)==null?void 0:L.id)===x.id?"bg-opacity-30":"bg-opacity-10"}`,style:((T=this.selectedFriend)==null?void 0:T.id)===x.id?`background-color: ${v.primary}30;`:"background-color: rgba(255, 255, 255, 0.1);"});M.innerHTML=`
        <div class="flex items-center justify-between">
          <span class="font-medium">${x.username}</span>
          <span class="w-3 h-3 rounded-full ${x.status==="online"?"bg-green-400":"bg-gray-400"}"></span>
        </div>
      `,M.addEventListener("click",()=>{this.selectedFriend=x,this.refreshModal()}),y.appendChild(M)});const b=u("+ Aggiungi Amico","text-white px-4 py-2 rounded text-sm hover:opacity-90 transition-opacity focus:outline-none w-full",()=>alert("Aggiungi Amico"));b.style.backgroundColor=v.primary;const F=a("input",{className:"bg-gray-800 text-white px-4 py-2 rounded text-sm w-full mt-2",placeholder:"id amico"});g.appendChild(p),g.appendChild(y),g.appendChild(b),g.appendChild(F),f.appendChild(g);const E=a("td",{className:"w-2/3 align-top"}),S=this.createChatContent(e);return E.appendChild(S),c.appendChild(f),c.appendChild(E),h.appendChild(c),l.appendChild(h),o.appendChild(l),i.appendChild(t),i.appendChild(n),i.appendChild(o),s.appendChild(i),s.addEventListener("click",x=>{x.target===s&&this.hide()}),s}createChatContent(e){const s=a("div",{className:"h-full flex flex-col"});if(this.selectedFriend){const i=a("div",{className:"flex items-center mb-4"}),t=a("h3",{className:"text-lg font-bold",innerHTML:`Chat con ${this.selectedFriend.username}`,style:`color: ${v.primary};`}),n=a("span",{className:`ml-3 w-3 h-3 rounded-full ${this.selectedFriend.status==="online"?"bg-green-400":"bg-gray-400"}`});i.appendChild(t),i.appendChild(n);const o=a("div",{className:"flex-1 overflow-y-auto bg-gray-800 rounded p-4 mb-4 space-y-3"}),l=this.messages[this.selectedFriend.id]||[],h=(e==null?void 0:e.username)||"Tu";l.forEach(p=>{const y=a("div",{className:`flex ${p.sender===h?"justify-end":"justify-start"}`}),b=a("div",{className:`max-w-xs px-3 py-2 rounded text-sm ${p.sender===h?"text-white":"bg-gray-600 text-white"}`});p.sender===h&&(b.style.backgroundColor=v.primary),b.innerHTML=`
          <div class="font-medium text-xs mb-1 opacity-70">${p.sender}</div>
          <div>${p.content}</div>
        `,y.appendChild(b),o.appendChild(y)});const c=a("div",{className:"flex gap-2"}),f=a("input",{className:"flex-1 px-3 py-2 rounded bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Scrivi un messaggio..."});f.value=this.newMessage,f.addEventListener("input",p=>{this.newMessage=p.target.value}),f.addEventListener("keypress",p=>{p.key==="Enter"&&this.sendMessage(h)});const g=u("Invia","text-white px-4 py-2 rounded hover:opacity-90 transition-opacity focus:outline-none",()=>this.sendMessage(h));g.style.backgroundColor=v.primary,c.appendChild(f),c.appendChild(g),s.appendChild(i),s.appendChild(o),s.appendChild(c)}else{const i=a("div",{className:"h-full flex items-center justify-center"}),t=a("p",{className:"text-gray-400 text-center",innerHTML:"Seleziona un amico per iniziare a chattare"});i.appendChild(t),s.appendChild(i)}return s}sendMessage(e){if(!this.selectedFriend||!this.newMessage.trim())return;const s={id:Date.now(),sender:e,content:this.newMessage,timestamp:new Date};this.messages[this.selectedFriend.id]||(this.messages[this.selectedFriend.id]=[]),this.messages[this.selectedFriend.id].push(s),this.newMessage="",this.refreshModal()}refreshModal(){this.modalElement&&(document.body.removeChild(this.modalElement),this.modalElement=this.createModal(),document.body.appendChild(this.modalElement))}destroy(){this.hide()}}class be{constructor(){this.profileModal=new ve,this.socialModal=new ye,this.element=this.createNavbar(),this.bindAuthState()}bindAuthState(){this.unsubscribe=d.subscribe(()=>{this.updateNavbar()})}createNavbar(){const e=a("nav",{className:"fixed left-0 top-0 h-full w-44 py-6 px-4 flex flex-col shadow-lg z-50",style:"background-color: #3B2E27;"});return this.element=e,this.updateNavbar(),e}updateNavbar(){const{user:e}=d.getState();for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);const s=a("div",{className:"mb-8"}),i=u(`<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
      </svg>
      <span class="text-sm">Home</span>`,"text-white font-semibold text-lg flex flex-col items-center gap-2 hover:text-orange-300 transition-colors w-full p-4",()=>N.navigate("/"));i.style.color="#E67923",s.appendChild(i),this.element.appendChild(s);const t=a("div",{className:"flex-1 flex flex-col justify-center"});e&&t.appendChild(this.createAuthenticatedButtons(e)),this.element.appendChild(t)}createAuthenticatedButtons(e){const s=a("div",{className:"flex flex-col gap-4 w-full"}),i=a("div",{className:"text-white text-center text-sm mb-4 px-2",innerHTML:`Ciao, ${e.username}!`}),t=u("Profilo","text-white px-3 py-2 rounded transition-all focus:outline-none w-full text-center",()=>this.profileModal.show());t.style.backgroundColor="#E67923",t.addEventListener("mouseenter",()=>{t.style.backgroundColor="#D16A1E"}),t.addEventListener("mouseleave",()=>{t.style.backgroundColor="#E67923"});const n=u("Play","text-white px-3 py-2 rounded-md transition-all w-full text-center bg-orange-500 hover:bg-orange-600 focus:outline-none",()=>N.navigate("/play")),o=u("Social","text-white px-3 py-2 rounded-md transition-all w-full text-center bg-orange-500 hover:bg-orange-600 focus:outline-none",()=>this.socialModal.show()),l=u("Logout","text-white px-3 py-2 rounded transition-all focus:outline-none w-full text-center",()=>{d.logout(),N.navigate("/")});return l.style.backgroundColor="#6B7280",l.addEventListener("mouseenter",()=>{l.style.backgroundColor="#4B5563"}),l.addEventListener("mouseleave",()=>{l.style.backgroundColor="#6B7280"}),s.appendChild(i),s.appendChild(t),s.appendChild(n),s.appendChild(o),s.appendChild(l),s}getElement(){return this.element}destroy(){this.unsubscribe&&this.unsubscribe(),this.profileModal.destroy(),this.socialModal.destroy()}}const m={primary:"#E67923",dark:"#2A2A2A",darkText:"#3C3C3C",loginButton:"#B20000",loginButtonHover:"#D32F2F",white:"#ffffff",lightGray:"#f5f5f5"},xe=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;class we{constructor(e=!0){this.isVisible=!1,this.activeTab="login",this.formData={email:"",username:"",password:"",confirmPassword:""},this.errors={},this.showCloseButton=!0,this.showCloseButton=e,this.bindAuthState()}bindAuthState(){this.unsubscribe=d.subscribe(()=>{this.updateErrorDisplay()})}show(){this.isVisible||(this.isVisible=!0,this.modalElement=this.createModal(),document.body.appendChild(this.modalElement))}hide(){!this.isVisible||!this.modalElement||(this.isVisible=!1,document.body.removeChild(this.modalElement),this.modalElement=void 0,this.resetForm())}createModal(){const e=a("div",{className:"fixed inset-0 flex items-center justify-center z-50"});this.showCloseButton&&e.addEventListener("click",o=>{o.target===e&&this.hide()});const s=a("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 h-[500px] overflow-hidden flex flex-col",style:`background-color: ${m.dark};`});if(s.addEventListener("click",o=>o.stopPropagation()),this.showCloseButton){const o=a("div",{className:"relative px-6 pt-4 pb-4"}),l=u("√ó","absolute top-4 right-4 hover:opacity-70 transition-opacity focus:outline-none text-2xl",()=>this.hide());l.style.color=m.primary,o.appendChild(l),s.appendChild(o)}const i=this.createTabs();s.appendChild(i);const t=a("div",{className:"flex-1 flex flex-col"}),n=this.createForm();return t.appendChild(n),s.appendChild(t),e.appendChild(s),e}createTabs(){const e=a("div",{className:"px-6 mt-4"});return[{id:"login",label:"Log In"},{id:"register",label:"Sign Up"}].forEach(i=>{const t=u(i.label,"pb-3 px-1 text-lg font-semibold border-b-2 transition-all mr-8 focus:outline-none hover:opacity-70",()=>this.switchTab(i.id));t.style.color=this.activeTab===i.id?m.primary:m.darkText,t.style.borderBottomColor=this.activeTab===i.id?m.primary:"transparent",e.appendChild(t)}),e}createForm(){const e=a("form",{className:"flex flex-col gap-5 pt-4 px-8 pb-6 flex-1 min-h-[300px] items-center"});e.addEventListener("submit",o=>this.handleSubmit(o));const s=a("div",{className:"w-full max-w-sm mb-4"});this.updateMessageContainer(s);const i=a("div",{className:"flex flex-col gap-6 flex-grow w-full max-w-sm"});i.appendChild(this.createField("email","Email Address","email","Enter your email address...")),this.activeTab==="register"&&i.appendChild(this.createField("username","Username","text","Enter your username...")),i.appendChild(this.createField("password","Password","password",this.activeTab==="login"?"Enter your password...":"Create a password...")),this.activeTab==="register"&&i.appendChild(this.createField("confirmPassword","Confirm Password","password","Confirm your password...")),this.activeTab==="login"&&i.appendChild(a("div",{className:"h-16"}));const t=this.createDivider(),n=this.createButtons();return e.appendChild(s),e.appendChild(i),e.appendChild(t),e.appendChild(n),e}createField(e,s,i,t){const n=a("div",{className:"flex flex-col items-center"}),o=a("label",{className:"block text-sm font-medium text-white text-center mb-2 w-full",innerHTML:s}),l=he(i,t,`w-4/5 px-4 py-3 border rounded-lg outline-none transition-all text-center text-black placeholder-gray-500 ${this.errors[e]?"border-red-500":"border-gray-700"} bg-gray-100`);l.value=this.formData[e],l.addEventListener("input",c=>this.handleInputChange(e,c.target.value));const h=a("p",{className:"text-red-500 text-sm mt-1 text-center",innerHTML:this.errors[e]||""});return n.appendChild(o),n.appendChild(l),this.errors[e]&&n.appendChild(h),n}createDivider(){const e=a("div",{className:"relative my-6 w-full max-w-sm"}),s=a("div",{className:"absolute inset-0 flex items-center"}),i=a("div",{className:"w-full border-t",style:`border-color: ${m.darkText};`}),t=a("div",{className:"relative flex justify-center text-sm"}),n=a("span",{className:"px-4 text-white",innerHTML:"or",style:`background-color: ${m.dark};`});return s.appendChild(i),t.appendChild(n),e.appendChild(s),e.appendChild(t),e}createButtons(){const e=a("div",{className:"mt-auto w-full max-w-sm"}),s=a("div",{className:"flex gap-3 mb-4 h-12"}),{isLoading:i}=d.getState(),t=u(i?"Loading...":this.activeTab==="login"?"Log in":"Create Account","flex-1 text-white py-3 px-4 rounded-lg font-semibold transition-all flex items-center justify-center focus:outline-none disabled:opacity-50",()=>this.handleFormSubmit());t.style.backgroundColor=m.loginButton,t.disabled=i,t.addEventListener("mouseenter",()=>{i||(t.style.backgroundColor=m.loginButtonHover)}),t.addEventListener("mouseleave",()=>{i||(t.style.backgroundColor=m.loginButton)});const n=this.createGoogleButton();return s.appendChild(t),s.appendChild(n),e.appendChild(s),e}createGoogleButton(){const e=u(`<svg class="w-5 h-5 mr-3" viewBox="0 0 24 24">
        <path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
        <path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
        <path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
        <path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
      </svg>
      Continue with Google`,"flex items-center justify-center px-4 py-3 border rounded-lg font-semibold cursor-pointer h-12 whitespace-nowrap transition-all focus:outline-none text-black");return e.style.backgroundColor=m.white,e.style.borderColor=m.darkText,e.style.color="#000000",e.addEventListener("mouseenter",()=>{e.style.backgroundColor=m.lightGray}),e.addEventListener("mouseleave",()=>{e.style.backgroundColor=m.white}),e}handleInputChange(e,s){this.formData[e]=s,this.errors[e]&&delete this.errors[e],d.clearError(),d.clearSuccessMessage()}switchTab(e){this.activeTab=e,this.resetForm(),this.refreshModal()}resetForm(){this.formData={email:"",username:"",password:"",confirmPassword:""},this.errors={}}refreshModal(){if(this.modalElement&&this.modalElement.parentNode){const e=this.createModal();this.modalElement.parentNode.replaceChild(e,this.modalElement),this.modalElement=e}}updateMessageContainer(e){const{error:s,successMessage:i}=d.getState();if(e.innerHTML="",s){const t=a("p",{className:"text-red-500 text-sm text-center bg-red-100 p-2 rounded",innerHTML:s});e.appendChild(t)}if(i){const t=a("p",{className:"text-green-500 text-sm text-center bg-green-100 p-2 rounded",innerHTML:i});e.appendChild(t)}}updateErrorDisplay(){if(this.modalElement){const e=this.modalElement.querySelector(".w-full.max-w-sm.mb-4");e&&this.updateMessageContainer(e)}}validateForm(){const e={};return xe.test(this.formData.email)||(e.email="Please enter a valid email address"),this.activeTab==="register"&&!this.formData.username.trim()&&(e.username="Username is required"),this.formData.password.length<6&&(e.password="Password must be at least 6 characters"),this.activeTab==="register"&&this.formData.password!==this.formData.confirmPassword&&(e.confirmPassword="Passwords do not match"),this.errors=e,Object.keys(e).length===0}handleSubmit(e){e.preventDefault(),this.handleFormSubmit()}async handleFormSubmit(){if(!this.validateForm()){this.refreshModal();return}try{this.activeTab==="login"?await d.login(this.formData.email,this.formData.password):await d.register(this.formData.email,this.formData.username,this.formData.password),this.hide()}catch(e){console.error("Auth error:",e)}}destroy(){this.hide(),this.unsubscribe&&this.unsubscribe()}}class Ce{constructor(e){this.container=e,this.authModal=new we(!1),this.bindAuthState(),this.checkAuthState()}bindAuthState(){this.unsubscribe=d.subscribe(()=>{this.checkAuthState()})}checkAuthState(){const{isAuthenticated:e,isLoading:s}=d.getState();s?this.showLoading():e?this.authModal.hide():this.authModal.show()}showLoading(){}setContent(e){const{isAuthenticated:s}=d.getState();s&&(this.currentContent=e,ee(e,this.container))}destroy(){this.unsubscribe&&this.unsubscribe(),this.authModal.destroy()}}class Me{constructor(){this.element=this.createPage()}createPage(){const e=a("div",{className:"p-6"}),s=a("h1",{className:"text-3xl font-bold text-gray-800 mb-6",innerHTML:"Benvenuto a ft_transcendence"}),i=a("div",{className:"bg-white rounded-lg shadow-md p-6"}),t=a("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-6"});return[{title:"Feature 1",bgClass:"bg-blue-50",textClass:"text-blue-800"},{title:"Feature 2",bgClass:"bg-green-50",textClass:"text-green-800"},{title:"Feature 3",bgClass:"bg-purple-50",textClass:"text-purple-800"}].forEach(o=>{const l=a("div",{className:`${o.bgClass} p-4 rounded-lg`}),h=a("h3",{className:`font-semibold ${o.textClass}`,innerHTML:o.title});l.appendChild(h),t.appendChild(l)}),i.appendChild(t),e.appendChild(s),e.appendChild(i),e}getElement(){return this.element}destroy(){}}class Le{constructor(){this.element=this.createPage()}createPage(){const e=a("div",{className:"p-6"}),s=a("h1",{className:"text-3xl font-bold text-gray-800 mb-6",innerHTML:"Gioca"}),i=a("div",{className:"bg-white rounded-lg shadow-md p-6"}),t=a("p",{className:"text-gray-600",innerHTML:"Inizia una nuova partita di Pong!"});return i.appendChild(t),e.appendChild(s),e.appendChild(i),e}getElement(){return this.element}destroy(){}}class Ne{constructor(){this.mainContent=this.initializeDOM(),this.navbar=new be,this.authGuard=new Ce(this.mainContent),this.setupRoutes(),this.bindAuthState(),document.body.appendChild(this.navbar.getElement()),N.start()}initializeDOM(){const e=document.getElementById("app");if(!e)throw new Error("App element not found");const s=a("div",{className:"min-h-screen bg-gray-100"}),i=a("div",{className:"ml-44 p-8 min-h-screen"});return s.appendChild(i),ee(s,e),i}setupRoutes(){N.addRoute("/",()=>this.renderPage(new Me)),N.addRoute("/play",()=>this.renderPage(new Le))}bindAuthState(){this.unsubscribe=d.subscribe(()=>{const{isAuthenticated:e}=d.getState();e?this.mainContent.style.display="block":this.mainContent.style.display="none"})}renderPage(e){const{isAuthenticated:s}=d.getState();this.currentPage&&this.currentPage.destroy(),this.currentPage=e,s&&this.authGuard.setContent(e.getElement())}destroy(){this.unsubscribe&&this.unsubscribe(),this.navbar.destroy(),this.authGuard.destroy(),this.currentPage&&this.currentPage.destroy()}}document.addEventListener("DOMContentLoaded",()=>{new Ne});
//# sourceMappingURL=index-CQze-09q.js.map
